<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á–µ—Ç –æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</title>
    <style>
        :root {{
            --primary-color: #2563eb;
            --danger-color: #dc2626;
            --warning-color: #f59e0b;
            --success-color: #10b981;
            --info-color: #3b82f6;
            --dark-color: #1f2937;
            --light-color: #f9fafb;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }}

        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}

        body {{
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--light-color);
            color: var(--text-primary);
            line-height: 1.6;
        }}

        .container {{
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }}

        /* Header */
        .report-header {{
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            color: white;
            padding: 3rem 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }}

        .report-title {{
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }}

        .report-subtitle {{
            font-size: 1.125rem;
            opacity: 0.9;
        }}

        /* Summary Cards */
        .summary-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }}

        .summary-card {{
            background: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--border-color);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }}

        .summary-card:hover {{
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }}

        .summary-card.critical {{
            border-left-color: var(--danger-color);
        }}

        .summary-card.high {{
            border-left-color: #ea580c;
        }}

        .summary-card.medium {{
            border-left-color: var(--warning-color);
        }}

        .summary-card.low {{
            border-left-color: var(--success-color);
        }}

        .summary-number {{
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }}

        .summary-card.critical .summary-number {{
            color: var(--danger-color);
        }}

        .summary-card.high .summary-number {{
            color: #ea580c;
        }}

        .summary-card.medium .summary-number {{
            color: var(--warning-color);
        }}

        .summary-card.low .summary-number {{
            color: var(--success-color);
        }}

        .summary-label {{
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }}

        /* Vulnerabilities Section */
        .vulnerabilities-section {{
            background: white;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            overflow: hidden;
        }}

        .section-header {{
            background: var(--light-color);
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-color);
        }}

        .section-title {{
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }}

        .section-description {{
            color: var(--text-secondary);
        }}

        /* Vulnerability Item */
        .vulnerability-item {{
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s ease;
        }}

        .vulnerability-item:last-child {{
            border-bottom: none;
        }}

        .vulnerability-item:hover {{
            background-color: #fafafa;
        }}

        .vulnerability-header {{
            padding: 1.5rem 2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }}

        .vulnerability-main {{
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }}

        .vulnerability-id {{
            background: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.875rem;
            min-width: 3rem;
            text-align: center;
        }}

        .vulnerability-title {{
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }}

        .vulnerability-badges {{
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }}

        .severity-badge {{
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }}

        .severity-critical {{
            background: #fef2f2;
            color: var(--danger-color);
            border: 1px solid #fecaca;
        }}

        .severity-high {{
            background: #fff7ed;
            color: #ea580c;
            border: 1px solid #fed7aa;
        }}

        .severity-medium {{
            background: #fffbeb;
            color: var(--warning-color);
            border: 1px solid #fde68a;
        }}

        .severity-low {{
            background: #f0fdf4;
            color: var(--success-color);
            border: 1px solid #bbf7d0;
        }}

        .module-badge {{
            background: #f3f4f6;
            color: var(--text-secondary);
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }}

        .expand-icon {{
            color: var(--text-secondary);
            transition: transform 0.3s ease;
            font-size: 1.25rem;
        }}

        .vulnerability-item.expanded .expand-icon {{
            transform: rotate(180deg);
        }}

        /* Vulnerability Details */
        .vulnerability-details {{
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }}

        .vulnerability-item.expanded .vulnerability-details {{
            max-height: 1000px;
        }}

        .details-content {{
            padding: 0 2rem 2rem;
        }}

        .details-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }}

        .detail-card {{
            background: var(--light-color);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
        }}

        .detail-label {{
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }}

        .detail-value {{
            color: var(--text-primary);
            font-weight: 500;
            word-break: break-all;
        }}

        .code-block {{
            margin-top: 1rem;
        }}

        .code-header {{
            background: var(--dark-color);
            color: white;
            padding: 0.75rem 1rem;
            font-weight: 600;
            font-size: 0.875rem;
            border-radius: 0.5rem 0.5rem 0 0;
        }}

        .code-content {{
            background: #1f2937;
            color: #e5e7eb;
            padding: 1rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
            border-radius: 0 0 0.5rem 0.5rem;
            border: 1px solid #374151;
        }}

        /* No Vulnerabilities */
        .no-vulnerabilities {{
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }}

        .no-vulnerabilities-icon {{
            font-size: 4rem;
            color: var(--success-color);
            margin-bottom: 1rem;
        }}

        .no-vulnerabilities h2 {{
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }}

        .no-vulnerabilities p {{
            color: var(--text-secondary);
            font-size: 1.125rem;
        }}

        /* Responsive Design */
        @media (max-width: 768px) {{
            .container {{
                padding: 1rem;
            }}

            .report-header {{
                padding: 2rem 1.5rem;
            }}

            .report-title {{
                font-size: 2rem;
            }}

            .summary-grid {{
                grid-template-columns: 1fr;
                gap: 1rem;
            }}

            .vulnerability-header {{
                padding: 1rem;
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }}

            .vulnerability-main {{
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
                width: 100%;
            }}

            .vulnerability-badges {{
                flex-wrap: wrap;
            }}

            .details-content {{
                padding: 0 1rem 1rem;
            }}

            .details-grid {{
                grid-template-columns: 1fr;
            }}
        }}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="report-header">
            <h1 class="report-title">üîí –û—Ç—á–µ—Ç –æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</h1>
            <p class="report-subtitle">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: {timestamp}</p>
        </div>

        <!-- Summary -->
        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-number">{total_vulns}</div>
                <div class="summary-label">–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ</div>
            </div>
            <div class="summary-card critical">
                <div class="summary-number">{critical_count}</div>
                <div class="summary-label">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ</div>
            </div>
            <div class="summary-card high">
                <div class="summary-number">{high_count}</div>
                <div class="summary-label">–í—ã—Å–æ–∫–∏–µ</div>
            </div>
            <div class="summary-card medium">
                <div class="summary-number">{medium_count}</div>
                <div class="summary-label">–°—Ä–µ–¥–Ω–∏–µ</div>
            </div>
            <div class="summary-card low">
                <div class="summary-number">{low_count}</div>
                <div class="summary-label">–ù–∏–∑–∫–∏–µ</div>
            </div>
        </div>

        <!-- Vulnerabilities -->
        <div class="vulnerabilities-section">
            <div class="section-header">
                <h2 class="section-title">–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</h2>
                <p class="section-description">–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
            </div>
            
            <div class="vulnerabilities-list">
                {vulnerabilities_content}
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {{
            // Toggle vulnerability details
            document.querySelectorAll('.vulnerability-header').forEach(header => {{
                header.addEventListener('click', function() {{
                    const item = this.closest('.vulnerability-item');
                    item.classList.toggle('expanded');
                }});
            }});

            // Smooth scrolling for better UX
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {{
                anchor.addEventListener('click', function (e) {{
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {{
                        target.scrollIntoView({{
                            behavior: 'smooth',
                            block: 'start'
                        }});
                    }}
                }});
            }});
        }});
    </script>
</body>
</html>
